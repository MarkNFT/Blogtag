!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).TezignTracerNew=e()}(this,function(){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&n(t,e)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function n(t,e){return(n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=u(n);return function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return a(t)}(this,i?(t=u(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function h(t){for(var e=1;e<arguments.length;e++){var n,i=arguments[e];for(n in i)t[n]=i[n]}return t}var f,l=function e(u,o){function n(t,e,n){if("undefined"!=typeof document){"number"==typeof(n=h({},o,n)).expires&&(n.expires=new Date(Date.now()+864e5*n.expires)),n.expires&&(n.expires=n.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i,r="";for(i in n)n[i]&&(r+="; "+i,!0!==n[i]&&(r+="="+n[i].split(";")[0]));return document.cookie=t+"="+u.write(e,t)+r}}return Object.create({set:n,get:function(t){if("undefined"!=typeof document&&(!arguments.length||t)){for(var e=document.cookie?document.cookie.split("; "):[],n={},i=0;i<e.length;i++){var r=e[i].split("="),o=r.slice(1).join("=");try{var s=decodeURIComponent(r[0]);if(n[s]=u.read(o,s),t===s)break}catch(t){}}return t?n[t]:n}},remove:function(t,e){n(t,"",h({},e,{expires:-1}))},withAttributes:function(t){return e(this.converter,h({},this.attributes,t))},withConverter:function(t){return e(h({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(o)},converter:{value:Object.freeze(u)}})}({read:function(t){return(t='"'===t[0]?t.slice(1,-1):t).replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),e="tz_tracer_visitor",d=/_sn=\w{8}\.\w{6}\.\w{6}_/,v="_sn",p="https://wx-mini-app/",g="https://tt-mini-app/",m="x-lang";(rt=f=f||{})[rt.web=1]="web",rt[rt.wx=2]="wx",rt[rt.tt=3]="tt",rt[rt.serviceWorker=4]="serviceWorker";function y(){var t,e,n=navigator.userAgent.toLowerCase(),i={versions:"unknown",type:"unknown",userAgent:"unknown"},r={IE:"undefined"!=typeof window&&((null===(t=window)||void 0===t?void 0:t.ActiveXObject)||"ActiveXObject"in window),Chrome:-1<n.indexOf("chrome")&&-1<n.indexOf("safari"),Firefox:-1<n.indexOf("firefox"),Opera:-1<n.indexOf("opera"),Safari:-1<n.indexOf("safari")&&-1===n.indexOf("chrome"),Edge:-1<n.indexOf("edge"),QQBrowser:/qqbrowser/.test(n),WeixinBrowser:/MicroMessenger/i.test(n)};for(e in r)if(r[e]){var o,s,u,a,c="";if("IE"===e)var h,c=(null===(h=n.match(/(msie\s|trident.*rv:)([\w.]+)/))||void 0===h?void 0:h[2])||"";else if("Chrome"===e){for(o in navigator.mimeTypes)"application/360softmgrplugin"===navigator.mimeTypes[o].type&&(e="360");c=(null===(s=n.match(/chrome\/([\d.]+)/))||void 0===s?void 0:s[1])||""}else"Firefox"===e?c=(null===(s=n.match(/firefox\/([\d.]+)/))||void 0===s?void 0:s[1])||"":"Opera"===e?c=(null===(u=n.match(/opera\/([\d.]+)/))||void 0===u?void 0:u[1])||"":"Safari"===e?c=(null===(u=n.match(/version\/([\d.]+)/))||void 0===u?void 0:u[1])||"":"Edge"===e?c=(null===(a=n.match(/edge\/([\d.]+)/))||void 0===a?void 0:a[1])||"":"QQBrowser"===e&&(c=(null===(a=n.match(/qqbrowser\/([\d.]+)/))||void 0===a?void 0:a[1])||"");i.type=e,i.versions=c,i.userAgent=n}return i}function w(){var t,e=navigator.userAgent,n=/(iPhone|Android|Windows Phone)/i.test(navigator.userAgent),i={iPhone:/iPhone/,iPad:/iPad/,Android:/Android/,Windows:/Windows/,Mac:/Macintosh/},r="",o="";for(t in i)if(i[t].test(e))if("Windows"===(r=t))try{o=e.split("Windows NT ")[1].split(";")[0]}catch(t){}else"Mac"===t?o=e.split("Mac OS X ")[1].split(")")[0]:"iPhone"===t?o=e.split("iPhone OS ")[1].split(" ")[0]:"iPad"===t?o=e.split("iPad; CPU OS ")[1].split(" ")[0]:"Android"===t&&(o=e.split("Android ")[1].split(";")[0]);return{name:r,version:o,isMobile:n}}function b(t,e){return t(e={exports:{}},e.exports),e.exports}var _=b(function(t,e){t.exports=function(){var c=1e3,h=6e4,f=36e5,a="millisecond",d="second",v="minute",p="hour",g="day",m="week",y="month",l="quarter",w="year",b="date",_="Invalid Date",s=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,S=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,t={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},o=function(t,e,n){var i=String(t);return!i||i.length>=e?t:""+Array(e+1-i.length).join(n)+t},e={s:o,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),i=Math.floor(n/60),r=n%60;return(e<=0?"+":"-")+o(i,2,"0")+":"+o(r,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var i=12*(n.year()-e.year())+(n.month()-e.month()),r=e.clone().add(i,y),o=n-r<0,s=e.clone().add(i+(o?-1:1),y);return+(-(i+(n-r)/(o?r-s:s-r))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:y,y:w,w:m,d:g,D:b,h:p,m:v,s:d,ms:a,Q:l}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},u="en",$={};$[u]=t;var i=function(t){return t instanceof T},r=function(t,e,n){var i;if(!t)return u;if("string"==typeof t)$[t]&&(i=t),e&&($[t]=e,i=t);else{var r=t.name;$[r]=t,i=r}return!n&&i&&(u=i),i||!n&&u},I=function(t,e){if(i(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new T(n)},O=e;O.l=r,O.i=i,O.w=function(t,e){return I(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var T=function(){function t(t){this.$L=r(t.locale,null,!0),this.parse(t)}var e=t.prototype;return e.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(O.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var i=e.match(s);if(i){var r=i[2]-1||0,o=(i[7]||"0").substring(0,3);return n?new Date(Date.UTC(i[1],r,i[3]||1,i[4]||0,i[5]||0,i[6]||0,o)):new Date(i[1],r,i[3]||1,i[4]||0,i[5]||0,i[6]||0,o)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},e.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},e.$utils=function(){return O},e.isValid=function(){return!(this.$d.toString()===_)},e.isSame=function(t,e){var n=I(t);return this.startOf(e)<=n&&n<=this.endOf(e)},e.isAfter=function(t,e){return I(t)<this.startOf(e)},e.isBefore=function(t,e){return this.endOf(e)<I(t)},e.$g=function(t,e,n){return O.u(t)?this[e]:this.set(n,t)},e.unix=function(){return Math.floor(this.valueOf()/1e3)},e.valueOf=function(){return this.$d.getTime()},e.startOf=function(t,e){var i=this,r=!!O.u(e)||e,n=O.p(t),o=function(t,e){var n=O.w(i.$u?Date.UTC(i.$y,e,t):new Date(i.$y,e,t),i);return r?n:n.endOf(g)},s=function(t,e){return O.w(i.toDate()[t].apply(i.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(e)),i)},u=this.$W,a=this.$M,c=this.$D,h="set"+(this.$u?"UTC":"");switch(n){case w:return r?o(1,0):o(31,11);case y:return r?o(1,a):o(0,a+1);case m:var f=this.$locale().weekStart||0,l=(u<f?u+7:u)-f;return o(r?c-l:c+(6-l),a);case g:case b:return s(h+"Hours",0);case p:return s(h+"Minutes",1);case v:return s(h+"Seconds",2);case d:return s(h+"Milliseconds",3);default:return this.clone()}},e.endOf=function(t){return this.startOf(t,!1)},e.$set=function(t,e){var n,i=O.p(t),r="set"+(this.$u?"UTC":""),o=(n={},n[g]=r+"Date",n[b]=r+"Date",n[y]=r+"Month",n[w]=r+"FullYear",n[p]=r+"Hours",n[v]=r+"Minutes",n[d]=r+"Seconds",n[a]=r+"Milliseconds",n)[i],s=i===g?this.$D+(e-this.$W):e;if(i===y||i===w){var u=this.clone().set(b,1);u.$d[o](s),u.init(),this.$d=u.set(b,Math.min(this.$D,u.daysInMonth())).$d}else o&&this.$d[o](s);return this.init(),this},e.set=function(t,e){return this.clone().$set(t,e)},e.get=function(t){return this[O.p(t)]()},e.add=function(n,t){var e,i=this;n=Number(n);var r=O.p(t),o=function(t){var e=I(i);return O.w(e.date(e.date()+Math.round(t*n)),i)};if(r===y)return this.set(y,this.$M+n);if(r===w)return this.set(w,this.$y+n);if(r===g)return o(1);if(r===m)return o(7);var s=(e={},e[v]=h,e[p]=f,e[d]=c,e)[r]||1,u=this.$d.getTime()+n*s;return O.w(u,this)},e.subtract=function(t,e){return this.add(-1*t,e)},e.format=function(t){var r=this,e=this.$locale();if(!this.isValid())return e.invalidDate||_;var o=t||"YYYY-MM-DDTHH:mm:ssZ",n=O.z(this),i=this.$H,s=this.$m,u=this.$M,a=e.weekdays,c=e.months,h=function(t,e,n,i){return t&&(t[e]||t(r,o))||n[e].substr(0,i)},f=function(t){return O.s(i%12||12,t,"0")},l=e.meridiem||function(t,e,n){var i=t<12?"AM":"PM";return n?i.toLowerCase():i},d={YY:String(this.$y).slice(-2),YYYY:this.$y,M:u+1,MM:O.s(u+1,2,"0"),MMM:h(e.monthsShort,u,c,3),MMMM:h(c,u),D:this.$D,DD:O.s(this.$D,2,"0"),d:String(this.$W),dd:h(e.weekdaysMin,this.$W,a,2),ddd:h(e.weekdaysShort,this.$W,a,3),dddd:a[this.$W],H:String(i),HH:O.s(i,2,"0"),h:f(1),hh:f(2),a:l(i,s,!0),A:l(i,s,!1),m:String(s),mm:O.s(s,2,"0"),s:String(this.$s),ss:O.s(this.$s,2,"0"),SSS:O.s(this.$ms,3,"0"),Z:n};return o.replace(S,function(t,e){return e||d[t]||n.replace(":","")})},e.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},e.diff=function(t,e,n){var i,r=O.p(e),o=I(t),s=(o.utcOffset()-this.utcOffset())*h,u=this-o,a=O.m(this,o);return a=(i={},i[w]=a/12,i[y]=a,i[l]=a/3,i[m]=(u-s)/6048e5,i[g]=(u-s)/864e5,i[p]=u/f,i[v]=u/h,i[d]=u/c,i)[r]||u,n?a:O.a(a)},e.daysInMonth=function(){return this.endOf(y).$D},e.$locale=function(){return $[this.$L]},e.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),i=r(t,e,!0);return i&&(n.$L=i),n},e.clone=function(){return O.w(this.$d,this)},e.toDate=function(){return new Date(this.valueOf())},e.toJSON=function(){return this.isValid()?this.toISOString():null},e.toISOString=function(){return this.$d.toISOString()},e.toString=function(){return this.$d.toUTCString()},t}(),n=T.prototype;return I.prototype=n,[["$ms",a],["$s",d],["$m",v],["$H",p],["$W",g],["$M",y],["$y",w],["$D",b]].forEach(function(e){n[e[1]]=function(t){return this.$g(t,e[0],e[1])}}),I.extend=function(t,e){return t.$i||(t(e,T,I),t.$i=!0),I},I.locale=r,I.isDayjs=i,I.unix=function(t){return I(1e3*t)},I.en=$[u],I.Ls=$,I.p={},I}()}),S=b(function(t,e){var h,f,l;t.exports=(h="minute",f=/[+-]\d\d(?::?\d\d)?/g,l=/([+-]|\d\d)/g,function(t,e,r){var n=e.prototype;r.utc=function(t){return new e({date:t,utc:!0,args:arguments})},n.utc=function(t){var e=r(this.toDate(),{locale:this.$L,utc:!0});return t?e.add(this.utcOffset(),h):e},n.local=function(){return r(this.toDate(),{locale:this.$L,utc:!1})};var i=n.parse;n.parse=function(t){t.utc&&(this.$u=!0),this.$utils().u(t.$offset)||(this.$offset=t.$offset),i.call(this,t)};var o=n.init;n.init=function(){var t;this.$u?(t=this.$d,this.$y=t.getUTCFullYear(),this.$M=t.getUTCMonth(),this.$D=t.getUTCDate(),this.$W=t.getUTCDay(),this.$H=t.getUTCHours(),this.$m=t.getUTCMinutes(),this.$s=t.getUTCSeconds(),this.$ms=t.getUTCMilliseconds()):o.call(this)};var s=n.utcOffset;n.utcOffset=function(n,t){var e=this.$utils().u;if(e(n))return this.$u?0:e(this.$offset)?s.call(this):this.$offset;if("string"==typeof n&&null===(n=function(){var t=(void 0===n?"":n).match(f);if(!t)return null;var e=(""+t[0]).match(l)||["-",0,0],t=e[0],e=60*+e[1]+ +e[2];return 0==e?0:"+"===t?e:-e}()))return this;var i=Math.abs(n)<=16?60*n:n,e=this;return t?(e.$offset=i,e.$u=0===n):0!==n?(t=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset(),(e=this.local().add(i+t,h)).$offset=i,e.$x.$localOffset=t):e=this.utc(),e};var u=n.format;n.format=function(t){t=t||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return u.call(this,t)},n.valueOf=function(){var t=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||(new Date).getTimezoneOffset());return this.$d.valueOf()-6e4*t},n.isUTC=function(){return!!this.$u},n.toISOString=function(){return this.toDate().toISOString()},n.toString=function(){return this.toDate().toUTCString()};var a=n.toDate;n.toDate=function(t){return"s"===t&&this.$offset?r(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():a.call(this)};var c=n.diff;n.diff=function(t,e,n){if(t&&this.$u===t.$u)return c.call(this,t,e,n);var i=this.local(),t=r(t).local();return c.call(i,t,e,n)}})}),$=b(function(t,e){var c,h;t.exports=(c={year:0,month:1,day:2,hour:3,minute:4,second:5},h={},function(t,e,u){function a(t,e,n){void 0===n&&(n={});var i,r=new Date(t);return i=(void 0===n?{}:n).timeZoneName||"short",(n=h[t=e+"|"+i])||(n=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:i}),h[t]=n),n.formatToParts(r)}function o(t,e){for(var n=a(t,e),i=[],r=0;r<n.length;r+=1){var o=n[r],s=o.type,o=o.value,s=c[s];0<=s&&(i[s]=parseInt(o,10))}return e=i[3],e=i[0]+"-"+i[1]+"-"+i[2]+" "+(24===e?0:e)+":"+i[4]+":"+i[5]+":000",t=+t,(u.utc(e).valueOf()-(t-t%1e3))/6e4}var s,e=e.prototype;e.tz=function(t,e){void 0===t&&(t=s);var n=this.utcOffset(),i=this.toDate(),r=i.toLocaleString("en-US",{timeZone:t}),o=Math.round((i-new Date(r))/1e3/60),o=u(r).$set("millisecond",this.$ms).utcOffset(15*-Math.round(i.getTimezoneOffset()/15)-o,!0);return e&&(e=o.utcOffset(),o=o.add(n-e,"minute")),o.$x.$timezone=t,o},e.offsetName=function(t){var e=this.$x.$timezone||u.tz.guess(),t=a(this.valueOf(),e,{timeZoneName:t}).find(function(t){return"timezonename"===t.type.toLowerCase()});return t&&t.value};var i=e.startOf;e.startOf=function(t,e){if(!this.$x||!this.$x.$timezone)return i.call(this,t,e);var n=u(this.format("YYYY-MM-DD HH:mm:ss:SSS"));return i.call(n,t,e).tz(this.$x.$timezone,!0)},u.tz=function(t,e,n){var i=n&&e,n=n||e||s,e=o(+u(),n);if("string"!=typeof t)return u(t).tz(n);i=function(t,e,n){var i=t-60*e*1e3,r=o(i,n);if(e===r)return[i,e];n=o(i-=60*(r-e)*1e3,n);return r===n?[i,r]:[t-60*Math.min(r,n)*1e3,Math.max(r,n)]}(u.utc(t,i).valueOf(),e,n),e=i[0],i=i[1],i=u(e).utcOffset(i);return i.$x.$timezone=n,i},u.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},u.tz.setDefault=function(t){s=t}})});_().format(),_.extend(S),_.extend($);function I(){return _.tz.guess()}function O(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:16,e="";t--;)e+=D[Math.floor(Math.random()*E)];return e}var T,x,k,M,D="0123456789abcdefhijklmnopqrstuvwxyz",E=D.length;function C(){return"".concat(O(8),".").concat(R(),".").concat(R())}function R(){return Math.floor(Date.now()/1e3).toString(36)}function U(t){return parseInt(t,36)}function L(t){try{return t.defaultView&&t.defaultView.frameElement||null}catch(t){return null}}function A(t){this.time=t.time,this.target=t.target,this.rootBounds=W(t.rootBounds),this.boundingClientRect=W(t.boundingClientRect),this.intersectionRect=W(t.intersectionRect||j()),this.isIntersecting=!!t.intersectionRect;var e=this.boundingClientRect,t=e.width*e.height,e=this.intersectionRect,e=e.width*e.height;this.intersectionRatio=t?Number((e/t).toFixed(4)):this.isIntersecting?1:0}function H(t,e){var n,i,r,e=e||{};if("function"!=typeof t)throw new Error("callback must be a function");if(e.root&&1!=e.root.nodeType&&9!=e.root.nodeType)throw new Error("root must be a Document or Element");this._checkForIntersections=(n=this._checkForIntersections.bind(this),i=this.THROTTLE_TIMEOUT,r=null,function(){r=r||setTimeout(function(){n(),r=null},i)}),this._callback=t,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(e.rootMargin),this.thresholds=this._initThresholds(e.threshold),this.root=e.root||null,this.rootMargin=this._rootMarginValues.map(function(t){return t.value+t.unit}).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}function N(t,e,n,i){"function"==typeof t.addEventListener?t.addEventListener(e,n,i||!1):"function"==typeof t.attachEvent&&t.attachEvent("on"+e,n)}function P(t,e,n,i){"function"==typeof t.removeEventListener?t.removeEventListener(e,n,i||!1):"function"==typeof t.detatchEvent&&t.detatchEvent("on"+e,n)}function z(t){var e;try{e=t.getBoundingClientRect()}catch(t){}return e?e.width&&e.height?e:{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.right-e.left,height:e.bottom-e.top}:j()}function j(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function W(t){return!t||"x"in t?t:{top:t.top,y:t.top,bottom:t.bottom,left:t.left,x:t.left,right:t.right,width:t.width,height:t.height}}function Y(t,e){var n=e.top-t.top,t=e.left-t.left;return{top:n,left:t,height:e.height,width:e.width,bottom:n+e.height,right:t+e.width}}function F(t,e){for(var n=e;n;){if(n==t)return!0;n=q(n)}return!1}function q(t){var e=t.parentNode;return 9==t.nodeType&&t!=T?L(t):(e=e&&e.assignedSlot?e.assignedSlot.parentNode:e)&&11==e.nodeType&&e.host?e.host:e}function B(t){return t&&9===t.nodeType}function V(){var t=new Date,e=t.getMonth()+1,n=t.getDate(),i=t.getHours(),r=t.getMinutes(),o=t.getSeconds(),s=t.getMilliseconds();return 1<=e&&e<=9&&(e="0"+e),1<=n&&n<=9&&(n="0"+n),0<=i&&i<=9&&(i="0"+i),0<=r&&r<=9&&(r="0"+r),0<=o&&o<=9&&(o="0"+o),1<=s&&s<100&&(s=(Array(3).join("0")+s).slice(-3)),t.getFullYear()+"-"+e+"-"+n+" "+i+":"+r+":"+o+"."+s}"object"==typeof window&&("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype?"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return 0<this.intersectionRatio}}):(T=function(){for(var t=window.document,e=L(t);e;)e=L(t=e.ownerDocument);return t}(),x=[],M=k=null,H.prototype.THROTTLE_TIMEOUT=100,H.prototype.POLL_INTERVAL=null,H.prototype.USE_MUTATION_OBSERVER=!0,H._setupCrossOriginUpdater=function(){return k=k||function(t,e){M=t&&e?Y(t,e):j(),x.forEach(function(t){t._checkForIntersections()})}},H._resetCrossOriginUpdater=function(){M=k=null},H.prototype.observe=function(e){if(!this._observationTargets.some(function(t){return t.element==e})){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:e,entry:null}),this._monitorIntersections(e.ownerDocument),this._checkForIntersections()}},H.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter(function(t){return t.element!=e}),this._unmonitorIntersections(e.ownerDocument),0==this._observationTargets.length&&this._unregisterInstance()},H.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},H.prototype.takeRecords=function(){var t=this._queuedEntries.slice();return this._queuedEntries=[],t},H.prototype._initThresholds=function(t){t=t||[0];return(t=!Array.isArray(t)?[t]:t).sort().filter(function(t,e,n){if("number"!=typeof t||isNaN(t)||t<0||1<t)throw new Error("threshold must be a number between 0 and 1 inclusively");return t!==n[e-1]})},H.prototype._parseRootMargin=function(t){t=(t||"0px").split(/\s+/).map(function(t){t=/^(-?\d*\.?\d+)(px|%)$/.exec(t);if(!t)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(t[1]),unit:t[2]}});return t[1]=t[1]||t[0],t[2]=t[2]||t[0],t[3]=t[3]||t[1],t},H.prototype._monitorIntersections=function(e){var n,i,r,t=e.defaultView;t&&-1==this._monitoringDocuments.indexOf(e)&&(n=this._checkForIntersections,r=i=null,this.POLL_INTERVAL?i=t.setInterval(n,this.POLL_INTERVAL):(N(t,"resize",n,!0),N(e,"scroll",n,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in t&&(r=new t.MutationObserver(n)).observe(e,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),this._monitoringDocuments.push(e),this._monitoringUnsubscribes.push(function(){var t=e.defaultView;t&&(i&&t.clearInterval(i),P(t,"resize",n,!0)),P(e,"scroll",n,!0),r&&r.disconnect()}),t=this.root&&(this.root.ownerDocument||this.root)||T,e==t||(t=L(e))&&this._monitorIntersections(t.ownerDocument))},H.prototype._unmonitorIntersections=function(i){var r,t,e=this._monitoringDocuments.indexOf(i);-1!=e&&(r=this.root&&(this.root.ownerDocument||this.root)||T,this._observationTargets.some(function(t){if((e=t.element.ownerDocument)==i)return!0;for(;e&&e!=r;){var e,n=L(e);if((e=n&&n.ownerDocument)==i)return!0}return!1})||(t=this._monitoringUnsubscribes[e],this._monitoringDocuments.splice(e,1),this._monitoringUnsubscribes.splice(e,1),t(),i==r||(t=L(i))&&this._unmonitorIntersections(t.ownerDocument)))},H.prototype._unmonitorAllIntersections=function(){var t=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0;for(var e=this._monitoringUnsubscribes.length=0;e<t.length;e++)t[e]()},H.prototype._checkForIntersections=function(){var u,a;!this.root&&k&&!M||(u=this._rootIsInDom(),a=u?this._getRootRect():j(),this._observationTargets.forEach(function(t){var e=t.element,n=z(e),i=this._rootContainsTarget(e),r=t.entry,o=u&&i&&this._computeTargetAndRootIntersection(e,n,a),s=null;this._rootContainsTarget(e)?k&&!this.root||(s=a):s=j();o=t.entry=new A({time:window.performance&&performance.now&&performance.now(),target:e,boundingClientRect:n,rootBounds:s,intersectionRect:o});r?u&&i?this._hasCrossedThreshold(r,o)&&this._queuedEntries.push(o):r&&r.isIntersecting&&this._queuedEntries.push(o):this._queuedEntries.push(o)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this))},H.prototype._computeTargetAndRootIntersection=function(t,e,n){if("none"!=window.getComputedStyle(t).display){for(var i=e,r=q(t),o=!1;!o&&r;){var s,u,a,c,h=null,f=1==r.nodeType?window.getComputedStyle(r):{};if("none"==f.display)return null;if(r==this.root||9==r.nodeType?(o=!0,r==this.root||r==T?k&&!this.root?!M||0==M.width&&0==M.height?i=h=r=null:h=M:h=n:(u=(s=q(r))&&z(s),a=s&&this._computeTargetAndRootIntersection(s,u,n),u&&a?(r=s,h=Y(u,a)):i=r=null)):r!=(c=r.ownerDocument).body&&r!=c.documentElement&&"visible"!=f.overflow&&(h=z(r)),h&&(s=h,u=i,h=f=c=a=void 0,a=Math.max(s.top,u.top),c=Math.min(s.bottom,u.bottom),f=Math.max(s.left,u.left),h=Math.min(s.right,u.right),u=c-a,i=0<=(s=h-f)&&0<=u?{top:a,bottom:c,left:f,right:h,width:s,height:u}:null),!i)break;r=r&&q(r)}return i}},H.prototype._getRootRect=function(){var t,e;return e=this.root&&!B(this.root)?z(this.root):(t=(e=B(this.root)?this.root:T).documentElement,e=e.body,{top:0,left:0,right:t.clientWidth||e.clientWidth,width:t.clientWidth||e.clientWidth,bottom:t.clientHeight||e.clientHeight,height:t.clientHeight||e.clientHeight}),this._expandRectByRootMargin(e)},H.prototype._expandRectByRootMargin=function(n){var t=this._rootMarginValues.map(function(t,e){return"px"==t.unit?t.value:t.value*(e%2?n.width:n.height)/100}),t={top:n.top-t[0],right:n.right+t[1],bottom:n.bottom+t[2],left:n.left-t[3]};return t.width=t.right-t.left,t.height=t.bottom-t.top,t},H.prototype._hasCrossedThreshold=function(t,e){var n=t&&t.isIntersecting?t.intersectionRatio||0:-1,i=e.isIntersecting?e.intersectionRatio||0:-1;if(n!==i)for(var r=0;r<this.thresholds.length;r++){var o=this.thresholds[r];if(o==n||o==i||o<n!=o<i)return!0}},H.prototype._rootIsInDom=function(){return!this.root||F(T,this.root)},H.prototype._rootContainsTarget=function(t){var e=this.root&&(this.root.ownerDocument||this.root)||T;return F(e,t)&&(!this.root||e==t.ownerDocument)},H.prototype._registerInstance=function(){x.indexOf(this)<0&&x.push(this)},H.prototype._unregisterInstance=function(){var t=x.indexOf(this);-1!=t&&x.splice(t,1)},window.IntersectionObserver=H,window.IntersectionObserverEntry=A));function J(t){for(var e=0;e<(arguments.length<=1?0:arguments.length-1);e++){var n,i=e+1<1||arguments.length<=e+1?void 0:arguments[e+1];for(n in i)void 0!==i[n]&&(t[n]=i[n])}return t}function Z(t){var e,n="?";for(e in t)n+=e+"="+t[e]+"&";return n.substring(0,n.length-1)}function X(){return"undefined"!=typeof window&&"function"==typeof XMLHttpRequest?f.web:"undefined"!=typeof wx&&wx.getSystemInfo?f.wx:"undefined"!=typeof tt&&tt.getSystemInfo?f.tt:"undefined"!=typeof serviceWorker?f.serviceWorker:null}var Q=X(),G=function(){function t(){o(this,t),this.silent=!1,this.env="development",this.sessionTimeout=1800,this.initInfo={}}return s(t,[{key:"api",get:function(){return{production:"https://track-api.tezign.com/trackEvent",development:"https://test-track-api.tezign.com/trackEvent"}[this.env]}},{key:"getUserId",value:function(){var t=this.getStorage(e);return t||(t="visitor_"+O(),this.setStorage(e,t),t)}},{key:"init",value:function(t){var e=t.user_id,n=t.tenant_id,i=t.global_user_id,r=t.env,o=void 0===r?"development":r,s=t.silent,r=t.sessionTimeout,r=void 0===r?1800:r,t=t.distinct_id;this.silent=void 0!==s&&s,this.sessionTimeout=r,this.env=o,this.initInfo.user_id=String(e||this.getUserId()),this.initInfo.tenant_id=n,this.initInfo.global_user_id=String(i),this.initInfo.distinct_id=t,this.initSession()}},{key:"setGlobalData",value:function(t){J(this.initInfo,t)}},{key:"visit",value:function(){var t;this.refreshSession(),this.silent||(t=J({event_time:V()},this.getSysInfo(),this.initInfo),this.send(t))}},{key:"track",value:function(t){var e,n,i,r,o,s,u,a;!this.silent&&this.initInfo.tenant_id&&("Page_View"===t.event_type_code&&(e=t,f.web===Q&&(i=window.location.pathname+window.location.hash,e.event_properties={url:(null===(n=e.event_properties)||void 0===n?void 0:n.url)||window.location.href,host:(null===(n=e.event_properties)||void 0===n?void 0:n.host)||window.location.host,path:(null===(n=e.event_properties)||void 0===n?void 0:n.path)||i}),f.wx===Q&&(a=(i=getCurrentPages())[i.length-1],a=i.length&&a?(r=a.options,o=p+a.is+Z(r),a.is+Z(r)):(o=p+"404","404"),e.event_properties={url:(null===(r=e.event_properties)||void 0===r?void 0:r.url)||o,host:(null===(o=e.event_properties)||void 0===o?void 0:o.host)||p,path:(null===(o=e.event_properties)||void 0===o?void 0:o.path)||a}),f.tt===Q&&(a=(o=getCurrentPages())[o.length-1],a=o.length&&a?(s=a.options,u=g+a.is+Z(s),a.is+Z(s)):(u=g+"404","404"),e.event_properties={url:(null===(s=e.event_properties)||void 0===s?void 0:s.url)||u,host:(null===(u=e.event_properties)||void 0===u?void 0:u.host)||g,path:(null===(e=e.event_properties)||void 0===e?void 0:e.path)||a})),t=J({event_time:V()},this.getSysInfo(),this.initInfo,t),this.send(t))}}]),t}(),K=function(){t(n,G);var e=c(n);function n(){var t;return o(this,n),r(a(t=e.call(this)),"dataList",[]),r(a(t),"dataAllList",[]),r(a(t),"trackEvent",{eventCode:"",eventChanel:""}),r(a(t),"time",2e3),r(a(t),"timer",0),r(a(t),"container","#scrollExposureContainer"),r(a(t),"maxNum",20),r(a(t),"observer",void 0),t.platform=f.web,t.sysInfo=t.initSysInfo(),t}return s(n,[{key:"setStorage",value:function(t,e){localStorage.setItem(t,JSON.stringify(e))}},{key:"getStorage",value:function(t){t=localStorage.getItem(t);return t=t&&JSON.parse(t)}},{key:"getSysInfo",value:function(){return this.sysInfo}},{key:"initSysInfo",value:function(){var t=y(),e=w();return{os:e.name,os_version:e.version,user_agent:t.userAgent,browser:t.type,browser_version:t.versions,source_from:e.isMobile?"h5":"web",device_id:""}}},{key:"getUrl",value:function(){return window.location.href}},{key:"initSession",value:function(){this.getUrl().match(d)?this.refreshSession():this.initInfo.session=C()}},{key:"refreshSession",value:function(){var t,e,n=this.initInfo.session;n?(t=n.lastIndexOf("."),e=U(n.substr(t+1,6)),Math.round(Date.now()/1e3)-e>this.sessionTimeout?this.initInfo.session=C():this.initInfo.session=n.substring(0,t)+"."+R()):this.initInfo.session=C()}},{key:"send",value:function(t){try{var e=new XMLHttpRequest;e.open("POST",this.api,!0),e.setRequestHeader("Content-Type","application/json"),e.onreadystatechange=function(){var t;4===e.readyState&&(200===e.status&&e.responseText||e.responseText&&(t=JSON.parse(e.responseText),console.warn("埋点失败",t)))},e.send(JSON.stringify(t))}catch(t){}}},{key:"exposureInit",value:function(t,e,n){var u=this;n&&(u.container=n),e&&(u.maxNum=e),t&&(u.time=t),u.observer=new IntersectionObserver(function(t){t.forEach(function(t){if(t.isIntersecting)try{var e;u.timer&&clearTimeout(u.timer);var n=t.target.attributes["data-exposure-param"].value,i=JSON.parse(n),r=localStorage.getItem("exposureCode");if(u.trackEvent.eventCode&&u.trackEvent.eventCode!==r&&localStorage.setItem("exposureCode",i.code),!i.id)return;var o={exposureId:i.id,exposureUrl:i.url},s={exposureId:i.id,exposureUrl:i.url,exposureCode:i.code};u.dataList.push(o),u.dataAllList.push(s),u.trackEvent={eventCode:i.code,eventChanel:i.channel},null!==(e=u.observer)&&void 0!==e&&e.unobserve(t.target),u.dataList.length>=u.maxNum?u.sendData():0<u.dataList.length&&(u.timer=window.setTimeout(function(){u.sendData()},u.time))}catch(t){console.log("暴露埋点error: ",t)}})},{root:document.querySelector(u.container),rootMargin:"0px",threshold:.5})}},{key:"add",value:function(t){var e=(t||{}).el,t=null===(t=this.dataAllList)||void 0===t?void 0:t.find(function(t){return"".concat("exposure-content-").concat(t.exposureId)===(null==e?void 0:e.id)&&t.exposureCode===e.dataset.exposureCode});this.observer&&e&&!t&&this.observer.observe(e)}},{key:"sendData",value:function(){var t=this.dataList.splice(0,this.maxNum),t={event_time:V(),event_type_code:this.trackEvent.eventCode,event_properties:{channel:this.trackEvent.eventChanel,exposure_params:JSON.stringify(t)}};this.track(t)}}]),n}(),et=function(){function e(){o(this,e)}return s(e,null,[{key:"createEventHandler",value:function(r){return function(t){for(var e=t.target;e&&e!==document;){var n=e.getAttribute.bind(e),i=n("data-track-click");if(i){try{i=JSON.parse(i),r(i)}catch(t){}if("true"!==n("data-track-bubble"))break}if(!(e=e.parentNode))break}}}},{key:"bindEvent",value:function(t){e.eventhandler||(e.eventhandler=e.createEventHandler(t),document.addEventListener("click",e.eventhandler))}},{key:"removeEvent",value:function(){e.eventhandler&&(document.removeEventListener("click",e.eventhandler),e.eventhandler=void 0)}}]),e}();new K;var nt=function(){t(n,G);var e=c(n);function n(){var t;return o(this,n),(t=e.call(this)).platform=f.web,t.sysInfo=t.initSysInfo(),t}return s(n,[{key:"setStorage",value:function(t,e){localStorage.setItem(t,JSON.stringify(e))}},{key:"getStorage",value:function(t){t=localStorage.getItem(t);return t=t&&JSON.parse(t)}},{key:"getSysInfo",value:function(){return this.sysInfo}},{key:"initSysInfo",value:function(){var t=y(),e=w();return{os:e.name,os_version:e.version,user_agent:t.userAgent,browser:t.type,browser_version:t.versions,source_from:e.isMobile?"h5":"web",device_id:"",window_width:window.innerWidth,window_height:window.innerHeight,resolution:"".concat(window.screen.width,"*").concat(window.screen.height),timezone:I(),language:l.get(m),preferred_locale:window.navigator.language}}},{key:"getUrl",value:function(){return window.location.href}},{key:"initSession",value:function(){this.getUrl().match(d)?this.refreshSession():this.initInfo.session=C()}},{key:"refreshSession",value:function(){var t,e,n=this.initInfo.session;n?(t=n.lastIndexOf("."),e=U(n.substr(t+1,6)),Math.round(Date.now()/1e3)-e>this.sessionTimeout?this.initInfo.session=C():this.initInfo.session=n.substring(0,t)+"."+R()):this.initInfo.session=C()}},{key:"send",value:function(t){try{var e=new XMLHttpRequest;e.open("POST",this.api,!0),e.setRequestHeader("Content-Type","application/json"),e.onreadystatechange=function(){var t;4===e.readyState&&(200===e.status&&e.responseText||e.responseText&&(t=JSON.parse(e.responseText),console.warn("埋点失败",t)))},e.send(JSON.stringify(t))}catch(t){}}}],[{key:"initClickTrack",value:function(t){var e=new n;return e.init(t),et.bindEvent(e.track.bind(e)),et}}]),n}(),it=function(){t(r,G);var i=c(r);function r(t,e){var n;return o(this,r),(n=i.call(this)).global=t,n.sourceForm=e,n.sysInfo=n.initSysInfo(),n}return s(r,[{key:"setStorage",value:function(t,e){this.global.setStorageSync(t,e)}},{key:"getStorage",value:function(t){return this.global.getStorageSync(t)}},{key:"getSysInfo",value:function(){return this.sysInfo}},{key:"initSession",value:function(){this.getStorage(v)?this.refreshSession():this.initInfo.session=C()}},{key:"refreshSession",value:function(){var t=this.getStorage(v)||"",e=t.lastIndexOf("."),n=U(t.substr(e+1,6));Math.round(Date.now()/1e3)-n>this.sessionTimeout?this.initInfo.session=C():(e=t.substring(0,e)+"."+R(),this.setStorage(v,e),this.initInfo.session=e)}},{key:"send",value:function(t){this.global.request({url:this.api,method:"POST",data:t,header:{"content-type":"application/json"},success:function(t){}})}},{key:"initSysInfo",value:function(){var t=this.global.getSystemInfoSync();return{os:t.system,os_version:t.version,user_agent:"",browser:"",browser_version:"",source_from:this.sourceForm,device_id:t.model,window_width:t.windowWidth,window_height:t.windowHeight,resolution:"".concat(t.screenWidth,"*").concat(t.screenHeight),timezone:I(),language:this.global.getStorageSync(m)||"",preferred_locale:t.language}}}],[{key:"initClickTrack",value:function(t){console.warn("小程序环境不支持无侵入点击埋点事件绑定")}}]),r}();r(it,"initExposureTrack",function(t){console.warn("小程序环境不支持无侵入暴露埋点事件绑定")});var rt=function(){t(n,it);var e=c(n);function n(){var t;return o(this,n),r(a(t=e.call(this,wx,"weapp")),"platform",f.wx),r(a(t),"host",p),t}return s(n,[{key:"getUrl",value:function(){var t=getCurrentPages(),e=t[t.length-1];if(!t.length||!e)return this.host+"404";t=e.route,e=e.options;return this.host+t+Z(e)}}]),n}(),S=function(){t(n,it);var e=c(n);function n(){var t;return o(this,n),r(a(t=e.call(this,tt,"tt")),"platform",f.tt),r(a(t),"host",g),t}return s(n,[{key:"getUrl",value:function(){var t=getCurrentPages(),e=t[t.length-1];if(!t.length||!e)return this.host+"404";t=e.options;return this.host+e.is+Z(t)}}]),n}(),$=function(){function t(){o(this,t)}return s(t,[{key:"init",value:function(){}},{key:"track",value:function(){}},{key:"setGlobalData",value:function(){}}],[{key:"initClickTrack",value:function(t){}}]),t}();r($,"initExposureTrack",function(t){});r(K={},f.web,nt),r(K,f.wx,rt),r(K,f.tt,S),S=K,K=X();return K&&S[K]||$});
